/*! r3vis - v0.1.0 - 2013-02-11
* http://github.com/hashd 
* Copyright (c) 2013 ; Licensed MIT */
var r3={};r3.Graph=function(){var e=this;return e.id=r3.util.getUniqueId(),e.graphdef=undefined,e.config=undefined,e.frame=undefined,e.panel=undefined,e.bg=undefined,e.effects={},e.axes={hor:{group:undefined,scale:undefined,func:undefined,axis:undefined,line:undefined,label:undefined},ver:{group:undefined,scale:undefined,func:undefined,axis:undefined,line:undefined,label:undefined}},e.labels=undefined,e.categories=undefined,e.$=undefined,this},r3.Graph.prototype.init=function(e,t){var n=this;return n.graphdef=e,n.config=$.extend(!0,{},r3.config,t),n.max(n.graphdef.stepup).position(n.config.meta.position||"#"+r3.constants.name.pos||"body").setDimensions().setFrame().setPanel().setBackground().setCaption().setSubCaption().setMetadata().setHorizontalAxis().setVerticalAxis().setEffectsObject(),this},r3.Graph.prototype.setDimensions=function(){var e=this;return e.height(e.config.dimension.height).width(e.config.dimension.width).top(e.config.margin.top).bottom(e.config.margin.bottom).left(e.config.margin.left).right(e.config.margin.right),this},r3.Graph.prototype.setFrame=function(){var e=this;return e.frame===undefined&&(e.frame=d3.select(e.position()||"body").append("svg")),e.frame.attr("id",r3.constants.name.frame+"_"+e.id).classed(r3.constants.name.frame,!0).attr("width",e.width()+e.left()+e.right()).attr("height",e.height()+e.top()+e.bottom()),e.frame.append("rect").classed("r3_frame_bg",!0).attr("width",e.width()+e.left()+e.right()).attr("height",e.height()+e.top()+e.bottom()).style("fill",e.config.frame.bgcolor),e.$=$("svg#"+r3.constants.name.frame+"_"+e.id),this},r3.Graph.prototype.setPanel=function(){var e=this;return e.panel===undefined&&(e.panel=e.frame.append("g")),e.panel.attr("id",r3.constants.name.panel+"_"+e.id).classed(r3.constants.name.panel,!0).attr("transform","translate("+e.left()+","+e.top()+")"),this},r3.Graph.prototype.setBackground=function(e){var t=this;return t.bg===undefined&&(t.bg=t.panel.append("rect").attr("class",r3.constants.name.background).attr("height",t.height()).attr("width",t.width())),t.bg.style("fill",e||t.config.graph.background),this},r3.Graph.prototype.setCaption=function(){var e=this;return e.caption=e.panel.append("g").attr("class","r3_caption"),e.caption.append("text").attr("class","r3_captiontext").text(e.config.meta.caption).attr("y",-e.config.margin.top/2).attr("x",e.config.dimension.width/2).attr("text-anchor",e.config.caption.textanchor).style("font-family",e.config.caption.fontfamily).style("font-size",e.config.caption.fontsize).style("font-weight",e.config.caption.fontweight).style("font-variant",e.config.caption.fontvariant).style("text-decoration",e.config.caption.textdecoration).on("mouseover",r3.effects.caption.mouseover(e.config)).on("mouseout",r3.effects.caption.mouseout(e.config)),this},r3.Graph.prototype.setSubCaption=function(){var e=this;return e.subCaption=e.panel.append("g").attr("class","r3_subCaption"),e.subCaption.append("text").attr("class","r3_subcaptiontext").text(e.config.meta.subCaption).attr("y",-e.config.margin.top/2+1*e.config.caption.fontsize).attr("x",e.config.dimension.width/2).attr("text-anchor",e.config.caption.textanchor).style("font-family",e.config.subCaption.fontfamily).style("font-size",e.config.subCaption.fontsize).style("font-weight",e.config.subCaption.fontweight).style("font-variant",e.config.subCaption.fontvariant).style("text-decoration",e.config.subCaption.textdecoration),this},r3.Graph.prototype.setMetadata=function(){var e=this;return e.labels=r3.util.getLabelArray(e.graphdef),e.categories=r3.util.getCategoryArray(e.graphdef),this},r3.Graph.prototype.setHorizontalAxis=function(){var e=this,t=e.graphdef;return e.axes.hor.group===undefined&&(e.axes.hor.group=e.panel.append("g").attr("class",r3.constants.name.horaxis).attr("transform","translate(0,"+e.height()+")")),t.orientation==="Horizontal"?(e.axes.hor.scale=d3.scale.linear().domain([0,e.max()]).range([0,e.width()]).nice(),e.axes.hor.func=d3.svg.axis().scale(e.axes.hor.scale).ticks(e.config.axis.ticks).tickSize(-e.width(),e.config.axis.minor,0).tickPadding(e.config.axis.padding).tickSubdivide(e.config.axis.subticks).orient("bottom")):(e.axes.hor.scale=d3.scale.ordinal().rangeRoundBands([0,e.width()],e.config.scale.ordinality),e.axes.hor.func=d3.svg.axis().scale(e.axes.hor.scale).tickPadding(e.config.axis.padding).orient("bottom")),this},r3.Graph.prototype.setVerticalAxis=function(){var e=this,t=e.graphdef;return e.axes.ver.group===undefined&&(e.axes.ver.group=e.panel.append("g").attr("class",r3.constants.name.veraxis)),t.orientation==="Vertical"?(e.axes.ver.scale=d3.scale.linear().domain([e.max(),0]).range([0,e.height()]).nice(),e.axes.ver.func=d3.svg.axis().scale(e.axes.ver.scale).ticks(e.config.axis.ticks).tickSize(-e.height(),e.config.axis.minor,0).tickPadding(e.config.axis.padding).tickSubdivide(e.config.axis.subticks).orient("left")):(e.axes.ver.scale=d3.scale.ordinal().rangeRoundBands([0,e.height()],e.config.scale.ordinality),e.axes.ver.func=d3.svg.axis().scale(e.axes.ver.scale).tickPadding(e.config.axis.padding).orient("left")),this},r3.Graph.prototype.setEffectsObject=function(){var e=this;for(var t=0;t<e.categories.length;t++)e.effects[e.categories[t]]={};return e},r3.Graph.prototype.drawHorizontalAxis=function(){var e=this;return e.axes.hor.axis=e.axes.hor.group.append("g").style("font-family",e.config.label.fontfamily).style("font-size",e.config.label.fontsize).style("font-weight",e.config.label.fontweight).call(e.axes.hor.func),e.axes.hor.axis.selectAll("line").style("stroke",e.config.axis.strokecolor),e.axes.hor.axis.selectAll("path").style("fill","none"),e.axes.hor.line=e.panel.append("line").attr("class",r3.constants.name.horaxis).attr("y1",e.height()).attr("y2",e.height()).attr("x1","0").attr("x2",e.width()).style("stroke",e.config.axis.strokecolor),e.axes.hor.label=e.axes.hor.group.append("g").classed("r3_axeslabelgroup",!0).attr("transform","translate("+e.width()/2+","+(e.config.margin.bottom/2+1*e.config.label.fontsize)+")"),e.axes.hor.label.append("text").attr("display","block").attr("class","r3_axeslabel").classed("cal",!0).attr("text-anchor","middle").style("font-size",e.config.axis.fontsize).style("font-family",e.config.axis.fontfamily).text(e.config.axis.hlabel),e.axes.hor.label.append("text").attr("display","block").attr("y",1*e.config.axis.fontsize).attr("class","r3_axessublabel").classed("casl",!0).attr("text-anchor","middle").style("font-size",e.config.axis.fontsize-2).style("font-family",e.config.axis.fontfamily).text(e.config.axis.hsublabel),this},r3.Graph.prototype.drawVerticalAxis=function(){var e=this;return e.axes.ver.axis=e.axes.ver.group.append("g").style("font-family",e.config.label.fontfamily).style("font-size",e.config.label.fontsize).style("font-weight",e.config.label.fontweight).call(e.axes.ver.func),e.axes.ver.axis.selectAll("line").style("stroke",e.config.axis.strokecolor),e.axes.ver.axis.selectAll("path").style("fill","none"),e.axes.ver.line=e.panel.append("line").attr("class",r3.constants.name.veraxis).attr("y1",0).attr("y2",e.height()).style("stroke",e.config.axis.strokecolor),e.axes.ver.label=e.axes.ver.group.append("g").attr("transform","translate("+ -4*e.config.margin.left/5+","+e.height()/2+")rotate(270)"),e.axes.ver.label.append("text").attr("class","r3_axeslabel").attr("text-anchor","middle").classed("cal",!0).style("font-family",e.config.axis.fontfamily).style("font-size",e.config.axis.fontsize).text(e.config.axis.vlabel),e.axes.ver.label.append("text").attr("class","r3_axessublabel").attr("text-anchor","middle").attr("y",+e.config.axis.fontsize).classed("casl",!0).style("font-family",e.config.axis.fontfamily).style("font-size",e.config.axis.fontsize-2).text(e.config.axis.vsublabel),this},r3.Graph.prototype.setLegend=function(){var e=this,t=e.panel.append("g").attr("class","r3_legend").attr("transform","translate("+e.width()+","+10+")");return e.legends=t.selectAll("g").data(e.categories).enter().append("g").attr("transform",function(e,t){return"translate(10,"+10*(2*t-1)+")"}).attr("class",function(t,n){return"cl_"+e.categories[n]}).attr("disabled","false").on("mouseover",function(t,n){e.effects[t].mouseover()}).on("mouseout",function(t,n){e.effects[t].mouseout()}).on("click",function(t,n){r3.effects.legend.click(n,this,e)}),e.legends.append("rect").attr("class","r3_legendsign").attr("height",e.config.legend.symbolsize).attr("width",e.config.legend.symbolsize).style("fill",function(t,n){return r3.util.getColorBand(e.config,n)}).style("stroke","none"),e.legends.append("text").attr("class","r3_legendtext").text(function(t,n){return e.categories[n]}).attr("dx",e.config.legend.textmargin).attr("dy",".71em").attr("text-anchor","start").style("font-family",e.config.legend.fontfamily).style("font-size",e.config.legend.fontsize).style("font-weight",e.config.legend.fontweight),this},r3.Graph.prototype.finalize=function(e){var t=this;return t.drawHorizontalAxis().drawVerticalAxis().setLegend(),e&&console.log(t),this},r3.Graph.prototype.remove=function(){return this.frame.remove(),this},r3.Graph.prototype.removeCaption=function(){return this.caption.remove(),this},r3.Graph.prototype.removeLegend=function(){return this.legends[0]&&this.legends[0].parentNode.remove(),this},r3.Graph.prototype.removePanel=function(){return this.panel.remove(),this},r3.Graph.prototype.removeHorAxis=function(){return this.panel.selectAll("g."+r3.constants.name.horaxis+" > *").remove(),this.panel.selectAll("line."+r3.constants.name.horaxis).remove(),this},r3.Graph.prototype.removeVerAxis=function(){return this.panel.selectAll("g."+r3.constants.name.veraxis+" > *").remove(),this.panel.selectAll("line."+r3.constants.name.veraxis).remove(),this},r3.Graph.prototype.width=function(e){return e?(this.config.dimension.width=e,this):this.config.dimension.width},r3.Graph.prototype.height=function(e){return e?(this.config.dimension.height=e,this):this.config.dimension.height},r3.Graph.prototype.top=function(e){return e?(this.config.margin.top=e,this):this.config.margin.top},r3.Graph.prototype.bottom=function(e){return e?(this.config.margin.bottom=e,this):this.config.margin.bottom},r3.Graph.prototype.left=function(e){return e?(this.config.margin.left=e,this):this.config.margin.left},r3.Graph.prototype.right=function(e){return e?(this.config.margin.right=e,this):this.config.margin.right},r3.Graph.prototype.position=function(e){return e?(this.config.meta.position=e,this):this.config.meta.position},r3.Graph.prototype.caption=function(e){return e?(this.config.meta.caption=e,this):this.config.meta.caption},r3.Graph.prototype.subCaption=function(e){return e?(this.config.meta.subCaption=e,this):this.config.meta.caption},r3.Graph.prototype.max=function(e){return e===!0?(this.config.graph.max=r3.util.getStepMaxValue(this.graphdef),this):e===!1?(this.config.graph.max=r3.util.getMaxValue(this.graphdef),this):e==="percent"?(this.config.graph.max=100,this):this.config.graph.max},r3.Graph.prototype.toggleGraphGroup=function(e){var t=this,n=t.categories[e],r=t.frame.select("g.cge_"+n).style("display"),i=r3.util.getColorBand(t.config,e);return t.frame.selectAll("g.cge_"+n).style("display",r==="none"?null:"none"),this},r3.util={},r3.util.extend=function(e){function t(){}return t.prototype=e.prototype||e,new t},r3.util.getUniqueId=function(){return(new Date).getTime()},r3.util.getMaxValue=function(e){return d3.max(e.categories.map(function(t){return d3.max(e.dataset[t].map(function(e){return e.value}))}))},r3.util.getStepMaxValue=function(e){var t=e.dataset[e.categories[0]].map(function(){return 0});return e.categories.map(function(n){e.dataset[n].map(function(e,n){t[n]+=e.value})}),d3.max(t)},r3.util.getSumUpArray=function(e){var t=e.dataset[e.categories[0]].map(function(){return 0});return e.categories.map(function(n){e.dataset[n].map(function(e,n){t[n]+=e.value})}),t},r3.util.getPercentage=function(e,t){return e*100/t},r3.util.getDataArray=function(e){return e.categories.map(function(t){return e.dataset[t]})},r3.util.getTabularArray=function(e){var t=[],n,r,i,s,o=[];for(n=0,s=e.dataset[e.categories[0]].length;n<s;n+=1){o=[],o.push(e.dataset[e.categories[0]][n].name);for(r=0,i=e.categories.length;r<i;r+=1)o.push(e.dataset[e.categories[r]][n].value);t.push(o)}return t},r3.util.getLabelArray=function(e){return e.dataset[e.categories[0]].map(function(e){return e.name})},r3.util.getCategoryArray=function(e){return e.categories.map(function(e){return e})},r3.util.getCategoryData=function(e,t){return t.map(function(t){return e.dataset[t].map(function(e){return e.value})})},r3.util.transposeData=function(e){var t={},n,r,i,s,o,u,a,f=e.dataset[e.categories[0]].map(function(e){return e.name});for(n=0,i=f.length;n<i;n+=1)t[f[n]]=[];for(n=0,i=e.categories.length;n<i;n+=1){o=e.categories[n];for(r=0,s=e.dataset[o].length;r<s;r+=1)u=e.dataset[o][r].name,a=e.dataset[o][r].value,t[u].push({name:o,value:a})}e.categories=f,e.dataset=t},r3.util.getPascalCasedName=function(e){return e.substring(0,1).toUpperCase()+e.substring(1)},r3.util.getColorBand=function(e,t){var n=r3.palette[e.graph.palette].length;return r3.palette[e.graph.palette][t%n]},r3.config={graph:{palette:"Brink",background:"white",type:undefined,orientation:"Horizontal",max:0},meta:{position:"#r3_div",caption:"Usage of browsers by the years",subCaption:"Among major vendors"},dimension:{width:400,height:400},margin:{top:50,bottom:90,left:100,right:100},frame:{bgcolor:"#ccc"},axis:{ticks:8,subticks:1,padding:5,minor:-10,strokecolor:"#000",fontfamily:"Ubuntu",fontsize:"14",fontweight:"bold",hlabel:"Horizontal Axis Label",vlabel:"Vertical Axis Label",hsublabel:"h sublabel",vsublabel:"v sublabel"},label:{fontfamily:"Ubuntu",fontsize:"11",fontweight:"normal",strokecolor:"#000"},scale:{ordinality:.2},table:{tableclass:"r3_table",headerclass:"r3_header",bodyclass:"r3_body",footerclass:"r3_footer"},bar:{strokecolor:"none",fontfamily:"Arial",fontsize:"10",fontweight:"bold",textcolor:"black"},line:{interpolation:"linear"},area:{interpolation:"cardinal",offset:"zero",opacity:.2},pie:{fontfamily:"Ubuntu",fontsize:"14",fontweight:"normal",fontvariant:"small-caps",fontfill:"white",strokecolor:"none",strokewidth:2},donut:{fontfamily:"ubuntu",fontsize:"14",fontweight:"normal",fontvariant:"small-caps",fontfill:"white",factor:.4,strokecolor:"none",strokewidth:2},caption:{fontfamily:"Cambria",fontsize:"14",fontweight:"bold",fontvariant:"small-caps",textdecoration:"none",hovercolor:"dimgrey",textanchor:"middle"},subCaption:{fontfamily:"Cambria",fontsize:"9",fontweight:"normal",fontvariant:"normal",textdecoration:"none",textanchor:"middle"},legend:{fontfamily:"Ubuntu",fontsize:"12",fontweight:"normal",textmargin:15,symbolsize:10,inactive_color:"#DDD"},effects:{hovercolor:"red",strokecolor:"none",textcolor:"black",duration:800,hover:400}},r3.constants={},r3.constants.defaultHorGraphdef={pos:"#r3_div",orientation:"Horizontal",charttype:undefined,categories:["IE","Chrome","Firefox","Opera","Safari"],dataset:{IE:[{name:"2001",value:60},{name:"2002",value:70},{name:"2003",value:80},{name:"2004",value:90},{name:"2005",value:20}],Chrome:[{name:"2001",value:10},{name:"2002",value:30},{name:"2003",value:50},{name:"2004",value:90},{name:"2005",value:70}],Firefox:[{name:"2001",value:50},{name:"2002",value:150},{name:"2003",value:20},{name:"2004",value:80},{name:"2005",value:40}],Opera:[{name:"2001",value:90},{name:"2002",value:60},{name:"2003",value:30},{name:"2004",value:10},{name:"2005",value:70}],Safari:[{name:"2001",value:30},{name:"2002",value:10},{name:"2003",value:60},{name:"2004",value:90},{name:"2005",value:40}]}},r3.constants.defaultVerGraphdef={pos:"#r3_div",orientation:"Vertical",charttype:undefined,categories:["IE","Chrome","Firefox","Opera","Safari"],dataset:{IE:[{name:"2001",value:60},{name:"2002",value:70},{name:"2003",value:80},{name:"2004",value:90},{name:"2005",value:20}],Chrome:[{name:"2001",value:10},{name:"2002",value:30},{name:"2003",value:50},{name:"2004",value:90},{name:"2005",value:70}],Firefox:[{name:"2001",value:50},{name:"2002",value:150},{name:"2003",value:20},{name:"2004",value:80},{name:"2005",value:40}],Opera:[{name:"2001",value:90},{name:"2002",value:60},{name:"2003",value:30},{name:"2004",value:10},{name:"2005",value:70}],Safari:[{name:"2001",value:30},{name:"2002",value:10},{name:"2003",value:60},{name:"2004",value:90},{name:"2005",value:40}]}},r3.constants.name={pos:"r3_div",frame:"r3_frame",panel:"r3_panel",background:"r3_bg",horaxis:"r3_horaxis",veraxis:"r3_veraxis"},r3.effects={},r3.effects.bar={},r3.effects.bar.mouseover=function(e,t){var n=e.config,r=e.categories[t],i=function(){e.frame.selectAll("rect.cr_"+r).transition().duration(n.effects.hover).style("fill",n.effects.hovercolor).style("stroke",n.effects.strokecolor),e.frame.selectAll("text.cr_"+r).transition().duration(n.effects.hover).style("fill",n.effects.textcolor).style("opacity",1)};return e.effects[r].mouseover=i,i},r3.effects.bar.mouseout=function(e,t,n){var r=e.config,i=e.categories[t];n=n||r3.util.getColorBand(e.config,t);var s=function(){e.frame.selectAll("rect.cr_"+i).transition().duration(r.effects.hover).style("fill",n).style("stroke","none"),e.frame.selectAll("text.cr_"+i).transition().duration(r.effects.hover).style("fill","none")};return e.effects[i].mouseout=s,s},r3.effects.area={},r3.effects.area.mouseover=function(e,t){var n=e.config,r=e.categories[t],i=function(){e.frame.selectAll(".cge_"+r).select("path.area_"+r).transition().duration(n.effects.hover).style("fill",n.effects.hovercolor)};return e.effects[r].mouseover=i,i},r3.effects.area.mouseout=function(e,t){var n=e.config,r=e.categories[t],i=function(){e.frame.selectAll(".cge_"+r).select("path.area_"+r).transition().duration(n.effects.hover).style("fill",r3.util.getColorBand(n,t))};return e.effects[r].mouseout=i,i},r3.effects.line={},r3.effects.line.mouseover=function(e,t){var n=e.config,r=e.categories[t],i=function(){e.frame.selectAll(".cge_"+r).selectAll("circle").transition().duration(n.effects.hover).style("fill",n.effects.hovercolor).style("fill-opacity",1).style("stroke",n.effects.hovercolor),e.frame.selectAll(".cge_"+r).select("path").transition().duration(n.effects.hover).style("stroke",n.effects.hovercolor),e.frame.selectAll(".cge_"+r).selectAll("text").transition().duration(n.effects.hover).style("fill",n.effects.textcolor)};return e.effects[r].mouseover=i,i},r3.effects.line.mouseout=function(e,t,n){var r=e.config,i=e.categories[t],n=n||r3.util.getColorBand(e.config,t),s=function(){e.frame.selectAll(".cge_"+i).selectAll("circle").transition().duration(r.effects.hover).style("fill",n).style("fill-opacity",.6).style("stroke",n),e.frame.selectAll(".cge_"+i).select("path").transition().duration(r.effects.hover).style("stroke",n),e.frame.selectAll(".cge_"+i).selectAll("text").transition().duration(r.effects.hover).style("fill","none")};return e.effects[i].mouseout=s,s},r3.effects.caption={},r3.effects.caption.mouseover=function(e){return function(){d3.select(this.parentNode.parentNode).select("."+r3.constants.name.background).transition().duration(e.effects.duration).style("fill",e.caption.hovercolor)}},r3.effects.caption.mouseout=function(e){return function(){d3.select(this.parentNode.parentNode).select("."+r3.constants.name.background).transition().duration(e.effects.duration).style("fill",e.graph.background)}},r3.effects.donut={},r3.effects.donut.mouseover=function(e,t,n,r){return function(r){var i={x:t.centroid(r)[0]/5,y:t.centroid(r)[1]/5};d3.select(this.parentNode).transition().duration(n.effects.duration).attr("transform","translate("+(e.x+i.x)+","+(e.y+i.y)+")")}},r3.effects.donut.mouseout=function(e,t){return function(){d3.select(this.parentNode).transition().duration(t.effects.duration).attr("transform","translate("+e.x+","+e.y+")")}},r3.effects.pie={},r3.effects.pie.mouseover=function(e,t,n,r){return function(r){var i={x:t.centroid(r)[0]/5,y:t.centroid(r)[1]/5};d3.select(this.parentNode).transition().duration(n.effects.duration).attr("transform","translate("+(e.x+i.x)+","+(e.y+i.y)+")")}},r3.effects.pie.mouseout=function(e,t){return function(){d3.select(this.parentNode).transition().duration(t.effects.duration).attr("transform","translate("+e.x+","+e.y+")")}},r3.effects.legend={},r3.effects.legend.mouseover=function(e,t){return e.effects.group[e.categories[t]].mouseover},r3.effects.legend.mouseout=function(e,t){return e.effects.group[e.categories[t]].mouseout},r3.effects.legend.click=function(e,t,n){var r=d3.select(t).attr("disabled")==="false"?!1:!0;n.toggleGraphGroup(e),d3.select(t).select("rect").style("fill",r?r3.util.getColorBand(n.config,e):r3.config.legend.inactive_color),d3.select(t).select("text").style("fill",r?null:r3.config.legend.inactive_color),d3.select(t).attr("disabled",r?"false":"true")},r3.palette={Plain:["#1F77B4"],Simple:["#d42f3c","#85b1e6","#FD6D16","#dfe617"],RGB:["#bb2211","#2222bb","#22aa22","#9999aa","#223322"],Olive:["#B4AF91","#787746","#40411E","#32331D"],"Soil and Sky":["#928174","#AA9788","#BDE4E9","#A8E1E9","#90D1DA"],Candid:["#EADEA1","#808355","#4E493D","#3A301C","#3F7696"],Sulphide:["#949993","#615952","#343640","#A15026","#C7B091"],"New Moon":["#EEE6AB","#C5BC8E","#696758","#45484B","#36393B"],Nature:["#EEEFD8","#BECD8A","#73880A","#CCCC33","#E2EAA3"],Earth:["#862424","#D8D1B4","#B3AB8E","#F1F0E9","#353535"],Sea:["#334433","#6699aa","#88aaaa","#aacccc","#447799"],Lemon:["#eebb00","#ddaa00","#eecc00","#ffee11"],Water:["#2266bb","#3388dd","#55aaee","#bbddee","#113355"],Grass:["#00AF64","#36D729","#61D7A4","#007241"],Hash:["tomato","yellowgreen","midnightblue","lightseagreen","gold"],Soft:["#f1b2e1","#b1ddf3","#ffde89","#e3675c","#c2d985"],Brink:["#01243b","#5288d8","#9da7b2","#c5c5c5","#71c42b"],Bright:["#ef597b","#ff6d31","#73b66b","#ffcb18","#29a2c6"],Lint:["#667b99","#afbbd2","#ccd5e6","#e9eef6","#ff6637"]},r3.AreaGraph=function(e){var t=this;r3.Graph.apply(t,[e]),e.stepup=!1,t.init(e),t.areagroups=[],t.dataset=r3.util.getDataArray(t.graphdef);var n,r,i,s,o,u=t.graphdef.dataset[t.graphdef.categories[0]];t.axes[t.graphdef.orientation==="Horizontal"?"ver":"hor"].scale.domain(u.map(function(e){return e.name}));for(s=0,o=t.dataset.length;s<o;s+=1)r=t.panel.append("g").attr("class","cg_"+t.categories[s]).append("g").attr("class","cge_"+t.categories[s]).datum(t.dataset[s]),n={path:r,linefunc:undefined,areafunc:undefined,line:undefined,area:undefined},t["draw"+t.graphdef.orientation+"Area"](n,s),t.areagroups.push(n);t.finalize()},r3.AreaGraph.prototype=r3.util.extend(r3.Graph),r3.AreaGraph.prototype.drawHorizontalArea=function(e,t){var n=this,r=r3.util.getColorBand(n.config,t);n.axes.ver.scale.rangePoints([0,n.height()]),e.linefunc=d3.svg.line().x(function(e){return n.axes.hor.scale(e.value)}).y(function(e){return n.axes.ver.scale(e.name)+n.axes.ver.scale.rangeBand()/2}).interpolate(n.config.area.interpolation),e.areafunc=d3.svg.area().x0(n.axes.hor.scale(0)).x1(e.linefunc.x()).y(e.linefunc.y()).interpolate(n.config.area.interpolation),e.area=e.path.append("svg:path").attr("class","areapath_"+t).attr("d",e.areafunc).style("opacity",n.config.area.opacity).style("-moz-opacity",n.config.area.opacity).style("fill",r),e.line=e.path.append("svg:path").attr("class","linepath_"+t).attr("d",e.linefunc).style("stroke","white").style("fill","none"),e.path.selectAll(".dot").data(n.dataset[t]).enter().append("circle").attr("class","dot").attr("cx",e.linefunc.x()).attr("cy",e.linefunc.y()).attr("r",3.5).style("fill","white")},r3.AreaGraph.prototype.drawVerticalArea=function(e,t){var n=this,r=r3.util.getColorBand(n.config,t);n.axes.hor.scale.rangePoints([0,n.width()]),e.linefunc=d3.svg.line().x(function(e){return n.axes.hor.scale(e.name)+n.axes.hor.scale.rangeBand()/2}).y(function(e){return n.axes.ver.scale(e.value)}).interpolate(n.config.area.interpolation),e.areafunc=d3.svg.area().x(e.linefunc.x()).y0(e.linefunc.y()).y1(n.axes.ver.scale(0)).interpolate(n.config.area.interpolation),e.area=e.path.append("svg:path").attr("class","areapath_"+t).attr("d",e.areafunc).style("opacity",n.config.area.opacity).style("-moz-opacity",n.config.area.opacity).style("fill",r),e.line=e.path.append("svg:path").attr("class","linepath_"+t).attr("d",e.linefunc).style("stroke","white").style("fill","none"),e.path.selectAll(".dot").data(n.dataset[t]).enter().append("circle").attr("class","dot").attr("cx",e.linefunc.x()).attr("cy",e.linefunc.y()).attr("r",3.5).style("fill","white")},r3.BarGraph=function(e,t){var n=this;r3.Graph.call(n).setDefaults(e,t).init(e,t),n.bargroups={},n.axes[n.graphdef.orientation==="Horizontal"?"ver":"hor"].scale.domain(n.labels);var r,i=n.categories.length,s;for(r=0;r<i;r+=1)s=n.categories[r],n.bargroups[s]=n.panel.append("g").attr("class","r3_bargroup").classed("cg_"+s,!0),n["draw"+n.graphdef.orientation+"Bars"](r);n.finalize()},r3.BarGraph.prototype=r3.util.extend(r3.Graph),r3.BarGraph.prototype.setDefaults=function(e,t){return e.stepup=!1,this},r3.BarGraph.prototype.drawHorizontalBars=function(e){var t=this,n=r3.util.getColorBand(this.config,e),r=t.categories.length;bars=t.bargroups[t.categories[e]].selectAll("g").data(t.graphdef.dataset[t.categories[e]]).enter().append("g").attr("class","cge_"+t.categories[e]),bars.append("rect").attr("class",t.id+"_"+t.categories[e]).classed("cr_"+t.categories[e],!0).attr("height",t.axes.ver.scale.rangeBand()/r).attr("x",0).attr("y",function(e){return t.axes.ver.scale(e.name)}).style("stroke",t.config.bar.strokecolor).style("fill",n).on("mouseover",r3.effects.bar.mouseover(t,e)).on("mouseout",r3.effects.bar.mouseout(t,e)).transition().duration(t.config.effects.duration).delay(function(e,n){return n*t.config.effects.duration}).attr("width",function(e){return t.axes.hor.scale(e.value)}),bars.append("text").attr("y",function(e){return t.axes.ver.scale(e.name)+t.axes.ver.scale.rangeBand()/r/2}).attr("dx",4).attr("dy",".35em").attr("text-anchor","start").classed("cr_"+t.categories[e],!0).style("fill","none").style("font-family",t.config.bar.fontfamily).style("font-size",t.config.bar.fontsize).style("font-weight",t.config.bar.fontweight).text(function(e){return String(e.value)}).transition().duration(t.config.effects.duration).delay(function(e,n){return n*t.config.effects.duration}).attr("x",function(e){return t.axes.hor.scale(e.value)}),bars.append("svg:title").text(function(n,r){return t.categories[e]+" ["+t.labels[r]+"] : "+n.value}),t.bargroups[t.categories[e]].attr("transform","translate(0,"+e*t.axes.ver.scale.rangeBand()/r+")")},r3.BarGraph.prototype.drawVerticalBars=function(e){var t=this,n=r3.util.getColorBand(this.config,e),r=t.categories.length;bars=t.bargroups[t.categories[e]].selectAll("g").data(t.graphdef.dataset[t.categories[e]]).enter().append("g").attr("class","cge_"+t.categories[e]),bars.append("rect").attr("class",t.id+"_"+t.categories[e]).classed("cr_"+t.categories[e],!0).attr("height",0).attr("width",0).attr("x",function(e){return t.axes.hor.scale(e.name)}).attr("y",0).style("stroke",t.config.bar.strokecolor).style("fill",n).on("mouseover",r3.effects.bar.mouseover(t,e)).on("mouseout",r3.effects.bar.mouseout(t,e)).transition().duration(t.config.effects.duration).delay(e*t.config.effects.duration).attr("height",function(e){return t.height()-t.axes.ver.scale(e.value)}).attr("width",t.axes.hor.scale.rangeBand()/r),bars.append("text").attr("transform","scale(1,-1)").attr("x",function(e){return t.axes.hor.scale(e.name)+t.axes.hor.scale.rangeBand()/r/2}).attr("y",-10).attr("dx",0).attr("dy",".35em").attr("text-anchor","middle").classed("cr_"+t.categories[e],!0).style("fill","none").style("font-family",t.config.bar.fontfamily).style("font-size",t.config.bar.fontsize).style("font-weight",t.config.bar.fontweight).text(function(e){return String(e.value)}).transition().duration(t.config.effects.duration).delay(e*t.config.effects.duration).attr("y",function(e){return-(t.height()-t.axes.ver.scale(e.value))-10}),bars.append("svg:title").text(function(n,r){return t.categories[e]+" ["+t.labels[r]+"] : "+n.value}),t.bargroups[t.categories[e]].attr("transform","translate("+e*t.axes.hor.scale.rangeBand()/r+","+t.height()+") scale(1,-1)")},r3.DonutGraph=function(e){var t=this;r3.Graph.apply(t),t.init(e),t.radius=Math.min(t.height(),t.width())*2/5,t.center={x:t.width()/2,y:t.height()/2},t.category=e.categories[0];var n=r3.util.getCategoryData(t.graphdef,[t.category]),r=d3.svg.arc().innerRadius(t.radius*t.config.donut.factor).outerRadius(t.radius),i=d3.layout.pie();t.panel.data(n),t.arcs=t.panel.selectAll("g.arc").data(i).enter().append("g").attr("class","r_arc_"+t.category).attr("transform","translate("+t.center.x+","+t.center.y+")"),t.arcs.append("path").attr("d",r).style("fill",function(e,n){return r3.util.getColorBand(t.config,n)}).style("stroke",t.config.donut.strokecolor).style("stroke-width",t.config.donut.strokewidth).on("mouseover",r3.effects.donut.mouseover(t.center,r,t.config)).on("mouseout",r3.effects.donut.mouseout(t.center,t.config)),t.arcs.append("text").attr("transform",function(e){return"translate("+r.centroid(e)+")"}).attr("dy",".35em").attr("text-anchor","middle").style("fill",t.config.donut.fontfill).style("font-family",t.config.donut.fontfamily).style("font-size",t.config.donut.fontsize).style("font-weight",t.config.donut.fontweight).style("font-variant",t.config.donut.fontvariant).text(function(e){return String(e.value)}),t.arcs.append("svg:title").text(function(e,n){return t.labels[n]+" : "+e.value})},r3.DonutGraph.prototype=r3.util.extend(r3.Graph),r3.LineGraph=function(e,t){var n=this;r3.Graph.call(n).setDefaults(e).init(e,t),n.linegroups={},n.dataset=r3.util.getDataArray(n.graphdef);var r,i,s,o,u=n.categories.length,a=n.labels;n.axes[n.graphdef.orientation==="Horizontal"?"ver":"hor"].scale.domain(a);for(o=0;o<u;o+=1)i=n.panel.append("g").attr("class","cg_"+n.categories[o]).append("g").attr("class","cge_"+n.categories[o]).datum(n.dataset[o]),r={path:i,func:undefined},n["draw"+n.graphdef.orientation+"Lines"](r,o,color),n.linegroups[n.categories[o]]=r;n.finalize()},r3.LineGraph.prototype=r3.util.extend(r3.Graph),r3.LineGraph.prototype.setDefaults=function(e){return e.stepup=!1,this},r3.LineGraph.prototype.drawHorizontalLines=function(e,t){var n=this,r=n.axes,i=n.config,s=r3.util.getColorBand(n.config,t);return e.func=d3.svg.line().x(function(e){return r.hor.scale(e.value)}).y(function(e){return r.ver.scale(e.name)+r.ver.scale.rangeBand()/2}).interpolate(r3.config.line.interpolation),e.path.append("path").classed("cr_"+n.categories[t],!0).attr("d",e.func).style("fill","none").style("stroke",s).style("stroke-width",1.5).style("stroke-opacity",.01).on("mouseover",r3.effects.line.mouseover(n,t)).on("mouseout",r3.effects.line.mouseout(n,t,s)).transition().duration(3*n.config.effects.duration).delay(2*t*n.config.effects.duration).style("stroke-opacity",1),e.path.selectAll("circle").data(n.dataset[t]).enter().append("circle").classed("cr_"+n.categories[t],!0).attr("cx",e.func.x()).attr("cy",e.func.y()).attr("r",3.5).style("fill",s).style("fill-opacity",.6).style("stroke",s).on("mouseover",r3.effects.line.mouseover(n,t)).on("mouseout",r3.effects.line.mouseout(n,t,s)).append("svg:title").text(function(e,r){return n.categories[t]+" ["+n.labels[r]+"]: "+e.value}),e.path.selectAll("text").data(n.dataset[t]).enter().append("text").attr("x",function(e){return r.hor.scale(e.value)}).attr("y",function(e){return r.ver.scale(e.name)+r.ver.scale.rangeBand()/2}).attr("dx",10).attr("dy",".35em").attr("text-anchor","start").classed("cr_"+n.categories[t],!0).style("fill","none").style("font-family",n.config.bar.fontfamily).style("font-size",n.config.bar.fontsize).style("font-weight",n.config.bar.fontweight).text(function(e){return String(e.value)}),this},r3.LineGraph.prototype.drawVerticalLines=function(e,t){var n=this,r=n.axes,i=n.config,s=r3.util.getColorBand(n.config,t);return e.func=d3.svg.line().x(function(e){return r.hor.scale(e.name)+r.hor.scale.rangeBand()/2}).y(function(e){return r.ver.scale(e.value)}).interpolate(r3.config.line.interpolation),e.path.append("path").attr("d",e.func).classed("cr_"+n.categories[t],!0).style("fill","none").style("stroke",s).style("stroke-width",1.5).style("stroke-opacity",.01).on("mouseover",r3.effects.line.mouseover(n,t)).on("mouseout",r3.effects.line.mouseout(n,t,s)).transition().duration(n.config.effects.duration).delay(2*t*n.config.effects.duration).style("stroke-opacity",1),e.path.selectAll("circle").data(n.dataset[t]).enter().append("circle").attr("cx",e.func.x()).attr("cy",e.func.y()).attr("r",3.5).classed("cr_"+n.categories[t],!0).style("fill",s).style("fill-opacity",.2).style("stroke",s).on("mouseover",r3.effects.line.mouseover(n,t)).on("mouseout",r3.effects.line.mouseout(n,t,s)).append("svg:title").text(function(e,r){return n.categories[t]+" ["+n.labels[r]+"]: "+e.value}),e.path.selectAll("text").data(n.dataset[t]).enter().append("text").attr("x",function(e){return r.hor.scale(e.name)+r.hor.scale.rangeBand()/2}).attr("y",function(e){return r.ver.scale(e.value)-20}).attr("dx",0).attr("dy",".71em").attr("text-anchor","middle").classed("cr_"+n.categories[t],!0).style("fill","none").style("font-family",n.config.bar.fontfamily).style("font-size",n.config.bar.fontsize).style("font-weight",n.config.bar.fontweight).text(function(e){return String(e.value)}),this},r3.PercentAreaGraph=function(e){var t=this;r3.Graph.call(t,e),e.stepup="percent",t.init(e),stacklayout=d3.layout.stack().offset("zero")(t.categories.map(function(t){return e.dataset[t].map(function(e){return{x:e.name,y:+e.value}})}));var n,r,i,s=t.labels,o=t.categories;t.axes[t.graphdef.orientation==="Horizontal"?"ver":"hor"].scale.domain(s),t.areagroup=t.panel.selectAll("g.areagroup").data(stacklayout).enter().append("g").attr("class",function(e,n){return"cge_"+t.categories[n]}),t["draw"+t.graphdef.orientation+"Area"](),t.finalize(!0)},r3.PercentAreaGraph.prototype=r3.util.extend(r3.Graph),r3.PercentAreaGraph.prototype.drawHorizontalArea=function(){var e=this,t=e.axes,n=e.categories,r=e.config,i=r3.util.getSumUpArray(e.graphdef);t.ver.scale.rangePoints([0,e.height()]);for(var s=0;s<n.length;s+=1)r3.effects.area.mouseover(e,s),r3.effects.area.mouseout(e,s);e.areagroup.append("path").attr("class",function(e,t){return"area_"+n[t]}).style("fill",function(e,t){return r3.util.getColorBand(r,t)}).attr("d",d3.svg.area().y(function(e){return t.ver.scale(e.x)+t.ver.scale.rangeBand()/2}).x0(function(e,n){return t.hor.scale(r3.util.getPercentage(e.y0,i[n]))}).x1(function(e,n){return t.hor.scale(r3.util.getPercentage(e.y0+e.y,i[n]))}).interpolate(e.config.area.interpolation)).on("mouseover",function(t,r){e.effects[n[r]].mouseover()}).on("mouseout",function(t,r){e.effects[n[r]].mouseout()}),e.areagroup.append("path").attr("class",function(e,t){return"line_"+n[t]}).style("stroke","white").style("fill","none").style("stroke-width",2).attr("d",d3.svg.line().y(function(e){return t.ver.scale(e.x)+t.ver.scale.rangeBand()/2}).x(function(e,n){return t.hor.scale(r3.util.getPercentage(e.y0+e.y,i[n]))}).interpolate(e.config.area.interpolation))},r3.PercentAreaGraph.prototype.drawVerticalArea=function(){var e=this,t=e.axes,n=e.categories,r=e.config,i=r3.util.getSumUpArray(e.graphdef);t.hor.scale.rangePoints([0,e.width()]);for(var s=0;s<n.length;s+=1)r3.effects.area.mouseover(e,s),r3.effects.area.mouseout(e,s);e.areagroup.append("path").attr("class",function(e,t){return"area_"+n[t]}).style("fill",function(e,t){return r3.util.getColorBand(r,t)}).attr("d",d3.svg.area().x(function(e){return t.hor.scale(e.x)+t.hor.scale.rangeBand()/2}).y0(function(e,n){return t.ver.scale(r3.util.getPercentage(e.y0,i[n]))}).y1(function(e,n){return t.ver.scale(r3.util.getPercentage(e.y0+e.y,i[n]))}).interpolate(e.config.area.interpolation)).on("mouseover",function(t,r){e.effects[n[r]].mouseover()}).on("mouseout",function(t,r){e.effects[n[r]].mouseout()}),e.areagroup.append("path").attr("class",function(e,t){return"line_"+n[t]}).style("stroke","white").style("fill","none").style("stroke-width",2).attr("d",d3.svg.line().x(function(e,n){return t.hor.scale(e.x)+t.hor.scale.rangeBand()/2}).y(function(e,n){return t.ver.scale(r3.util.getPercentage(e.y0+e.y,i[n]))}).interpolate(e.config.area.interpolation))},r3.PercentBarGraph=function(e,t){var n=this;r3.Graph.call(n).setDefaults(e,t).init(e,t),n.bargroups=[];var r,i,s,o,u,a=n.labels,f=a.map(function(e){return 0}),l=a.map(function(e){return 0});n.axes[n.graphdef.orientation==="Horizontal"?"ver":"hor"].scale.domain(a);for(s=0,o=n.categories.length;s<o;s+=1)u=r3.util.getColorBand(n.config,s),r=n.panel.append("g").attr("class","cg_"+n.categories[s]),i=r.selectAll("g").data(n.graphdef.dataset[n.categories[s]]).enter().append("g").attr("class","cge_"+n.categories[s]),n["draw"+r3.util.getPascalCasedName(n.graphdef.orientation)+"Bars"](i,f,l,s),n.graphdef.orientation==="Vertical"&&r.attr("transform","translate(0,"+2*n.height()+") scale(1,-1)"),n.bargroups.push(r);n.finalize()},r3.PercentBarGraph.prototype=r3.util.extend(r3.Graph),r3.PercentBarGraph.prototype.setDefaults=function(e,t){return e.stepup="percent",t.scale.ordinality=0,this},r3.PercentBarGraph.prototype.drawHorizontalBars=function(e,t,n,r){var i=this,s=this.axes,o=r3.util.getColorBand(this.config,r),u=this.config,a=r3.util.getSumUpArray(this.graphdef);e.append("rect").attr("height",s.ver.scale.rangeBand()).attr("width",0).attr("x",function(e,n){var r=s.hor.scale(r3.util.getPercentage(t[n],a[n]));return t[n]+=e.value,r}).attr("y",function(e){return s.ver.scale(e.name)}).classed("cr_"+i.categories[r],!0).style("stroke","none").style("fill",o).on("mouseover",r3.effects.bar.mouseover(i,r)).on("mouseout",r3.effects.bar.mouseout(i,r)).transition().duration(r3.config.effects.duration).delay(r*r3.config.effects.duration).attr("width",function(e,t){return s.hor.scale(r3.util.getPercentage(e.value,a[t]))}),e.append("text").attr("y",function(e){return s.ver.scale(e.name)+s.ver.scale.rangeBand()/2}).attr("dx",0).attr("dy",".35em").attr("text-anchor","end").classed("cr_"+i.categories[r],!0).style("fill","none").style("font-family",this.config.bar.fontfamily).style("font-size",this.config.bar.fontsize).style("font-weight",this.config.bar.fontweight).text(function(e,n){return s.hor.scale(r3.util.getPercentage(t[n],a[n]))>15?String(Math.round(r3.util.getPercentage(e.value,a[n]))):null}).transition().duration(r3.config.effects.duration).delay(r*r3.config.effects.duration).attr("x",function(e,t){return n[t]+=e.value,s.hor.scale(r3.util.getPercentage(n[t],a[t]))-5})},r3.PercentBarGraph.prototype.drawVerticalBars=function(e,t,n,r){var i=this,s=this.height(),o=this.axes,u=r3.util.getColorBand(this.config,r),a=this.config,f=r3.util.getSumUpArray(this.graphdef);e.append("rect").attr("height",0).attr("width",o.hor.scale.rangeBand()).attr("x",function(e){return o.hor.scale(e.name)}).attr("y",function(e,n){var r=o.ver.scale(r3.util.getPercentage(t[n],f[n]));return t[n]-=e.value,r}).classed("cr_"+i.categories[r],!0).style("stroke","none").style("fill",u).on("mouseover",r3.effects.bar.mouseover(i,r)).on("mouseout",r3.effects.bar.mouseout(i,r)).transition().duration(r3.config.effects.duration).delay(r*r3.config.effects.duration).attr("height",function(e,t){return s-o.ver.scale(r3.util.getPercentage(e.value,f[t]))}),e.append("text").attr("transform","scale(1,-1)").attr("x",function(e){return o.hor.scale(e.name)+o.hor.scale.rangeBand()/2}).attr("y",-s+5).attr("dy",".71em").attr("text-anchor","middle").classed("cr_"+i.categories[r],!0).style("fill","none").style("font-family",this.config.bar.fontfamily).style("font-size",this.config.bar.fontsize).style("font-weight",this.config.bar.fontweight).text(function(e,t){return s-o.ver.scale(r3.util.getPercentage(e.value,f[t]))>15?String(Math.round(r3.util.getPercentage(e.value,f[t]))):null}).transition().duration(r3.config.effects.duration).delay(r*r3.config.effects.duration).attr("y",function(e,t){return n[t]+=e.value,-(2*s-o.ver.scale(r3.util.getPercentage(n[t],f[t])))+5})},r3.PieGraph=function(e){var t=this;r3.Graph.apply(t),t.init(e),t.radius=Math.min(t.height(),t.width())*2/5,t.center={x:t.width()/2,y:t.height()/2},t.category=e.categories[0];var n=r3.util.getCategoryData(t.graphdef,[t.category]),r=d3.svg.arc().innerRadius(0).outerRadius(t.radius),i=d3.layout.pie();t.panel.data(n),t.arcs=t.panel.selectAll("g.arc").data(i).enter().append("g").attr("class","r3_arc"+t.category).attr("transform","translate("+t.center.x+","+t.center.y+")"),t.arcs.append("path").attr("d",r).style("fill",function(e,n){return r3.util.getColorBand(t.config,n)}).style("stroke",t.config.pie.strokecolor).style("stroke-width",t.config.pie.strokewidth).on("mouseover",r3.effects.pie.mouseover(t.center,r,t.config)).on("mouseout",r3.effects.pie.mouseout(t.center,t.config)),t.arcs.append("text").attr("transform",function(e){return"translate("+r.centroid(e)+")"}).attr("dy",".35em").attr("text-anchor","middle").style("fill",t.config.pie.fontfill).style("font-family",t.config.pie.fontfamily).style("font-size",t.config.pie.fontsize).style("font-weight",t.config.pie.fontweight).style("font-variant",t.config.pie.fontvariant).text(function(e){return String(e.value)}),t.arcs.append("svg:title").text(function(e,n){return t.labels[n]+" : "+e.value})},r3.PieGraph.prototype=r3.util.extend(r3.Graph),r3.StackedAreaGraph=function(e,t){var n=this;r3.Graph.call(n,e).setDefaults(e,t).init(e,t);var r=d3.layout.stack().offset(n.config.area.offset)(n.categories.map(function(t){return e.dataset[t].map(function(e){return{x:e.name,y:+e.value}})}));n.axes[n.graphdef.orientation==="Horizontal"?"ver":"hor"].scale.domain(n.labels.map(function(e){return e})),n.areagroup=n.panel.append("g").selectAll("g").data(r).enter().append("g").attr("class",function(e,t){return"cge_"+n.categories[t]}),n["draw"+n.graphdef.orientation+"Area"](),n.finalize()},r3.StackedAreaGraph.prototype=r3.util.extend(r3.Graph),r3.StackedAreaGraph.prototype.setDefaults=function(e,t){return e.stepup=!0,this},r3.StackedAreaGraph.prototype.drawHorizontalArea=function(){var e=this,t=e.axes,n=e.categories,r=e.config;t.ver.scale.rangePoints([0,e.height()]);for(var i=0;i<n.length;i+=1)r3.effects.area.mouseover(e,i),r3.effects.area.mouseout(e,i);return e.areagroup.append("path").attr("class",function(e,t){return"area_"+n[t]}).style("fill",function(e,t){return r3.util.getColorBand(r,t)}).attr("d",d3.svg.area().y(function(e){return t.ver.scale(e.x)+t.ver.scale.rangeBand()/2}).x0(function(e){return t.hor.scale(e.y0)}).x1(function(e){return t.hor.scale(e.y0+e.y)}).interpolate(e.config.area.interpolation)).on("mouseover",function(t,r){e.effects[n[r]].mouseover()}).on("mouseout",function(t,r){e.effects[n[r]].mouseout()}),e.areagroup.append("path").attr("class",function(e,t){return"line_"+n[t]}).style("stroke","white").style("fill","none").style("stroke-width",2).attr("d",d3.svg.line().y(function(e){return t.ver.scale(e.x)+t.ver.scale.rangeBand()/2}).x(function(e){return t.hor.scale(e.y0+e.y)}).interpolate(e.config.area.interpolation)),e},r3.StackedAreaGraph.prototype.drawVerticalArea=function(){var e=this,t=e.axes,n=e.categories,r=e.config;t.hor.scale.rangePoints([0,e.width()]),e.areagroup.append("path").attr("class","r3_area");for(var i=0;i<n.length;i+=1)r3.effects.area.mouseover(e,i),r3.effects.area.mouseout(e,i);return e.areagroup.append("path").attr("class",function(e,t){return"area_"+n[t]}).style("fill",function(e,t){return r3.util.getColorBand(r,t)}).attr("d",d3.svg.area().x(function(e){return t.hor.scale(e.x)+t.hor.scale.rangeBand()/2}).y0(function(e){return t.ver.scale(e.y0)}).y1(function(e){return t.ver.scale(e.y0+e.y)}).interpolate(e.config.area.interpolation)).on("mouseover",function(t,r){e.effects[n[r]].mouseover()}).on("mouseout",function(t,r){e.effects[n[r]].mouseout()}),e.areagroup.append("path").attr("class",function(e,t){return"line_"+n[t]}).style("stroke","white").style("fill","none").style("stroke-width",2).attr("d",d3.svg.line().x(function(e){return t.hor.scale(e.x)+t.hor.scale.rangeBand()/2}).y(function(e){return t.ver.scale(e.y0+e.y)}).interpolate(e.config.area.interpolation)),e},r3.StackedBarGraph=function(e){var t=this;r3.Graph.call(t).setDefaults(e).init(e),t.bargroups={};var n,r,i,s,o,u=t.labels,a=u.map(function(e){return 0}),f=u.map(function(e){return 0});t.axes[t.graphdef.orientation==="Horizontal"?"ver":"hor"].scale.domain(u);for(i=0,s=t.categories.length;i<s;i+=1)t.bargroups[t.categories[i]]=t.panel.append("g").attr("class","cg_"+t.categories[i]),t["draw"+t.graphdef.orientation+"Bars"](i,a,f);t.finalize()},r3.StackedBarGraph.prototype=r3.util.extend(r3.Graph),r3.StackedBarGraph.prototype.setDefaults=function(e){return e.stepup=!0,this},r3.StackedBarGraph.prototype.drawHorizontalBars=function(e,t,n){var r=this,i=this.axes,s=r3.util.getColorBand(this.config,e),o=this.config,u=this.bargroups[this.categories[e]];bars=u.selectAll("g").data(this.graphdef.dataset[this.categories[e]]).enter().append("g").attr("class","cge_"+this.categories[e]),bars.append("rect").attr("height",i.ver.scale.rangeBand()).attr("width",0).attr("x",function(e,n){var r=i.hor.scale(t[n]);return t[n]+=e.value,r}).attr("y",function(e){return i.ver.scale(e.name)}).classed("cr_"+r.categories[e],!0).style("stroke","none").style("fill",s).on("mouseover",r3.effects.bar.mouseover(r,e)).on("mouseout",r3.effects.bar.mouseout(r,e)).transition().duration(r3.config.effects.duration).delay(e*r3.config.effects.duration).attr("width",function(e){return i.hor.scale(e.value)}),bars.append("text").attr("y",function(e){return i.ver.scale(e.name)+i.ver.scale.rangeBand()/2}).attr("dx",0).attr("dy",".35em").attr("text-anchor","end").classed("cr_"+r.categories[e],!0).style("fill","none").style("font-family",o.bar.fontfamily).style("font-size",o.bar.fontsize).style("font-weight",o.bar.fontweight).text(function(e){return i.hor.scale(e.value)>15?String(e.value):null}).transition().duration(r3.config.effects.duration).delay(e*r3.config.effects.duration).attr("x",function(e,t){return n[t]+=e.value,i.hor.scale(n[t])-5}),bars.append("svg:title").text(function(t,n){return r.categories[e]+" ["+r.labels[n]+"] : "+t.value})},r3.StackedBarGraph.prototype.drawVerticalBars=function(e,t,n){var r=this,i=this.height(),s=this.axes,o=r3.util.getColorBand(this.config,e),u=this.config,a=this.bargroups[this.categories[e]];bars=a.selectAll("g").data(this.graphdef.dataset[this.categories[e]]).enter().append("g").attr("class","r3_stackedbar_"+this.categories[e]),bars.append("rect").attr("height",0).attr("width",s.hor.scale.rangeBand()).attr("x",function(e){return s.hor.scale(e.name)}).attr("y",function(e,n){var r=s.ver.scale(t[n]);return t[n]-=e.value,r}).classed("cr_"+r.categories[e],!0).style("stroke","none").style("fill",o).on("mouseover",r3.effects.bar.mouseover(r,e)).on("mouseout",r3.effects.bar.mouseout(r,e)).transition().duration(r3.config.effects.duration).delay(e*r3.config.effects.duration).attr("height",function(e){return i-s.ver.scale(e.value)}),bars.append("text").attr("transform","scale(1,-1)").attr("x",function(e){return s.hor.scale(e.name)+s.hor.scale.rangeBand()/2}).attr("y",-i+5).attr("dy",".71em").attr("text-anchor","middle").classed("cr_"+r.categories[e],!0).style("fill","none").style("font-family",u.bar.fontfamily).style("font-size",u.bar.fontsize).style("font-weight",u.bar.fontweight).text(function(e){return i-s.ver.scale(e.value)>15?String(e.value):null}).transition().duration(r3.config.effects.duration).delay(e*r3.config.effects.duration).attr("y",function(e,t){return n[t]+=e.value,-(2*i-s.ver.scale(n[t]))+5}),bars.append("svg:title").text(function(t,n){return r.categories[e]+" ["+r.labels[n]+"] : "+t.value}),a.attr("transform","translate(0,"+2*this.height()+") scale(1,-1)")},r3.StepUpBarGraph=function(e,t){var n=this;r3.Graph.call(n).setDefaults(e).init(e,t),this.bargroups={};var r,i=n.categories.length,s=n.labels.map(function(e){return 0}),o=n.labels.map(function(e){return 0});n.axes[this.graphdef.orientation==="Horizontal"?"ver":"hor"].scale.domain(this.labels);for(r=0;r<i;r+=1)n.bargroups[n.categories[r]]=this.panel.append("g").attr("class","cg_"+n.categories[r]),n["draw"+n.graphdef.orientation+"Bars"](r,s,o);n.finalize()},r3.StepUpBarGraph.prototype=r3.util.extend(r3.Graph),r3.StepUpBarGraph.prototype.setDefaults=function(e){return e.stepup=!0,this},r3.StepUpBarGraph.prototype.drawHorizontalBars=function(e,t,n){var r=this,i=r.categories.length;color=r3.util.getColorBand(r.config,e),bargroup=r.bargroups[r.categories[e]],bars=bargroup.selectAll("g").data(r.graphdef.dataset[r.categories[e]]).enter().append("g").attr("class","cge_"+r.categories[e]),bars.append("rect").attr("height",r.axes.ver.scale.rangeBand()/i).attr("width",0).attr("x",function(e,n){var i=r.axes.hor.scale(t[n]);return t[n]+=e.value,i}).attr("y",function(e){return r.axes.ver.scale(e.name)}).classed("cr_"+r.categories[e],!0).style("stroke","none").style("fill",color).on("mouseover",r3.effects.bar.mouseover(r,e)).on("mouseout",r3.effects.bar.mouseout(r,e,color)).transition().duration(r.config.effects.duration).delay(e*r.config.effects.duration).attr("width",function(e){return r.axes.hor.scale(e.value)}),bars.append("text").attr("y",function(e){return r.axes.ver.scale(e.name)+r.axes.ver.scale.rangeBand()/i/2}).attr("dx",4).attr("dy",".35em").attr("text-anchor","start").classed("cr_"+r.categories[e],!0).style("fill","none").style("font-family",r.config.bar.fontfamily).style("font-size",r.config.bar.fontsize).style("font-weight",r.config.bar.fontweight).text(function(e){return String(e.value)}).transition().duration(r.config.effects.duration).delay(e*r.config.effects.duration).attr("x",function(e,t){return n[t]+=e.value,r.axes.hor.scale(n[t])}),bars.append("svg:title").text(function(t,n){return r.categories[e]+" ["+r.labels[n]+"] : "+t.value}),bargroup.attr("transform","translate(0,"+e*r.axes.ver.scale.rangeBand()/i+")")},r3.StepUpBarGraph.prototype.drawVerticalBars=function(e,t,n){var r=this,i=r.categories.length,s=r3.util.getColorBand(r.config,e),o=r.bargroups[r.categories[e]];bars=o.selectAll("g").data(r.graphdef.dataset[r.categories[e]]).enter().append("g").attr("class","cge_"+r.categories[e]),bars.append("rect").attr("height",0).attr("width",r.axes.hor.scale.rangeBand()/i).attr("x",function(e){return r.axes.hor.scale(e.name)}).attr("y",function(e,n){var i=r.axes.ver.scale(t[n]);return t[n]-=e.value,i}).classed("cr_"+r.categories[e],!0).style("stroke","none").style("fill",s).on("mouseover",r3.effects.bar.mouseover(r,e)).on("mouseout",r3.effects.bar.mouseout(r,e,s)).transition().duration(r.config.effects.duration).delay(e*r.config.effects.duration).attr("height",function(e){return r.height()-r.axes.ver.scale(e.value)}),bars.append("text").attr("transform","scale(1,-1)").attr("x",function(e){return r.axes.hor.scale(e.name)+r.axes.hor.scale.rangeBand()/i/2}).attr("y",-r.height()-10).attr("dy",".71em").attr("text-anchor","middle").classed("cr_"+r.categories[e],!0).style("fill","none").style("font-family",r.config.bar.fontfamily).style("font-size",r.config.bar.fontsize).style("font-weight",r.config.bar.fontweight).text(function(e){return String(e.value)}).transition().duration(r.config.effects.duration).delay(e*r.config.effects.duration).attr("y",function(e,t){return n[t]+=e.value,-(2*r.height()-r.axes.ver.scale(n[t]))-10}),bars.append("svg:title").text(function(t,n){return r.categories[e]+" ["+r.labels[n]+"] : "+t.value}),o.attr("transform","translate("+e*r.axes.hor.scale.rangeBand()/i+","+2*r.height()+") scale(1,-1)")},r3.Table=function(){this.caption=undefined,this.position=undefined,this.graphdef=undefined,this.table=undefined,this.header=undefined,this.body=undefined,this.bodyrows={}},r3.Table.prototype.init=function(e){this.graphdef=e,this.position=this.graphdef.pos||"#chart3rdiv"||"body",this.table=d3.select(this.position).append("table").attr("class",r3.config.table.tableclass),this.header=this.table.append("thead").attr("class",r3.config.table.headerclass),this.body=this.table.append("tbody").attr("class",r3.config.table.bodyclass)},r3.Table.prototype.finalize=function(){},r3.TableGraph=function(e){r3.Table.apply(this,[e]),this.init(e),this.graphdef.orientation==="hor"?this.setHorTable():this.setVerTable(),this.finalize()},r3.TableGraph.prototype=r3.util.extend(r3.Table),r3.TableGraph.prototype.setHorTable=function(){var e=this.graphdef.categories,t=r3.util.getTabularArray(this.graphdef);e.unshift(""),this.header.append("tr").selectAll("td").data(e).enter().append("td").text(function(e){return e}),e.shift(),this.bodyrows=this.body.selectAll("tr").data(t).enter().append("tr"),this.bodyrows.selectAll("td").data(function(e,n){return t[n]}).enter().append("td").attr("class",function(e,t){return t===0?"chart3rtablelabel":"chart3rtabledata"}).text(function(e){return e})},r3.TableGraph.prototype.setVerTable=function(){var e=r3.util.getLabelArray(this.graphdef),t=this.graphdef.dataset;e.unshift(""),this.header.append("tr").selectAll("td").data(e).enter().append("td").text(function(e){return e}),e.shift(),this.bodyrows=this.body.selectAll("tr").data(this.graphdef.categories).enter().append("tr"),this.bodyrows.selectAll("td").data(function(e){var n=[],r,i;n.push(e);for(r=0,i=t[e].length;r<i;r+=1)n.push(t[e][r].value);return n}).enter().append("td").attr("class",function(e,t){return t===0?"chart3rtablelabel":"chart3rtabledata"}).text(function(e){return e})};